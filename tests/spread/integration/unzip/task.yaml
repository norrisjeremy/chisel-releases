summary: Integration tests for unzip

execute: |
  rootfs="$(install-slices base-files_bin dash_bins unzip_bins zip_bins)"

  chroot "${rootfs}/" unzip -hh
  chroot "${rootfs}/" unzipsfx -hh
  
  echo "Hello, World" > "${rootfs}/testfile.txt"
  chroot "${rootfs}" zip testfile.zip testfile.txt
  chroot "${rootfs}" unzip -p testfile.zip testfile.txt > testfile_ext.txt
  test "$( cat testfile_ext.txt )" = '$( cat "${rootfs}/testfile.txt")'
  test "$(chroot "${rootfs}" zipinfo testfile.zip | head -n1)" = "Archive:  testfile.zip"
  test  '$( chroot "${rootfs}" funzip testfile.zip )' = "Hello, World"
  chroot "${rootfs}" zipgrep "Hello" testfile.zip
